macro(MEEDDetectPlatform)
    message(STATUS "CMAKE_SYSTEM_NAME: ${CMAKE_SYSTEM_NAME}")
    set(LINUX_BUILD OFF)
    set(WINDOW_BUILD OFF)
    set(WEB_BUILD OFF)

    if (CMAKE_SYSTEM_NAME STREQUAL "Linux")
        set(PLATFORM_DEFINITION PLATFORM_IS_LINUX)
        set(LINUX_BUILD ON)
    elseif (CMAKE_SYSTEM_NAME STREQUAL "Windows")
        set(PLATFORM_DEFINITION PLATFORM_IS_WINDOWS)
        set(WINDOW_BUILD ON)
    elseif (CMAKE_SYSTEM_NAME STREQUAL "Emscripten")
        set(PLATFORM_DEFINITION PLATFORM_IS_WEB)
        set(WEB_BUILD ON)
    else()
        message(FATAL "The system is not supported by this engine")
    endif()
endmacro()

macro(MEEDOption OPTION DEFAULT_VALUE)
    option(${OPTION} "Enable ${OPTION}" ${DEFAULT_VALUE})
endmacro()

macro(MEEDSetup)
    set(PROJECT_BASE_DIR "{{ BASE_DIR }}")
    set(EXTERNALS_DIR "{{ BASE_DIR }}/externals")
    set(CMAKE_MODULE_DIR "{{ BASE_DIR }}/cmake")

    MEEDOption(CMAKE_BUILD_TYPE Debug)

    MEEDDetectPlatform()

    set(COMMON_DEFINITIONS "${PLATFORM_DEFINITION}")

    if (CMAKE_BUILD_TYPE STREQUAL "Debug")
        list(APPEND COMMON_DEFINITIONS MEED_DEBUG)
    else()
        list(APPEND COMMON_DEFINITIONS MEED_RELEASE)
    endif()
endmacro()

macro(MEEDFindPackage PACKAGE_NAME FOLDER)
    set(CMAKE_FOLDER ${FOLDER})
    find_package(${PACKAGE_NAME} REQUIRED PATHS ${CMAKE_MODULE_DIR})
    unset(CMAKE_FOLDER CACHE)

    set(CMAKE_C_FLAGS "-m64")
    set(CMAKE_CXX_FLAGS "-m64")
endmacro()